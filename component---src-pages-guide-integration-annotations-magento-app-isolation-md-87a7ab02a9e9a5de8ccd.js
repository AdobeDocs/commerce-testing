"use strict";(self.webpackChunkcommerce_testing=self.webpackChunkcommerce_testing||[]).push([[4680],{32398:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return r},default:function(){return u}});var a,i=n(87462),o=n(63366),l=(n(15007),n(64983)),s=n(91515),d=["components"],r={},m=(a="InlineAlert",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,l.mdx)("div",e)}),p={_frontmatter:r},c=s.Z;function u(e){var t=e.components,n=(0,o.Z)(e,d);return(0,l.mdx)(c,(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,l.mdx)("h1",{id:"application-isolation-annotation"},"Application isolation annotation"),(0,l.mdx)("p",null,"An application state can be changed during test execution. Such changes can cause a false test failure."),(0,l.mdx)("p",null,"The integration testing framework keeps the tests isolated and provides optimal performance by default.\nIsolation is managed using the ",(0,l.mdx)("inlineCode",{parentName:"p"},"@magentoAppIsolation")," annotation."),(0,l.mdx)(m,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,l.mdx)("p",null,"Test execution order can vary depending on a PHPUnit version."),(0,l.mdx)("h2",{id:"format"},"Format"),(0,l.mdx)("p",null,"Application isolation annotation:"),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-php?start_inline=1"},"/**\n * @magentoAppIsolation enabled|disabled\n */\n")),(0,l.mdx)("h2",{id:"test-case-annotation"},"Test case annotation"),(0,l.mdx)("p",null,"The application and related objects are reinitialized after each test case execution.\nThis behavior helps to isolate application objects in different test cases.\nThe test case isolation is mandatory and cannot be disabled."),(0,l.mdx)(m,{variant:"warning",slots:"text",mdxType:"InlineAlert"}),(0,l.mdx)("p",null,"Do not share and do not rely on sharing the application objects between test cases."),(0,l.mdx)("h2",{id:"test-annotation"},"Test annotation"),(0,l.mdx)("p",null,"By default, the application isolation (that is automatic reinitialization) in tests is disabled.\nTo enable the application isolation for a test, use the ",(0,l.mdx)("inlineCode",{parentName:"p"},"@magentoAppIsolation")," annotation."),(0,l.mdx)("p",null,"Example:"),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-php?start_inline=1"},"/**\n * @magentoAppIsolation enabled\n */\npublic function testGetAddressById()\n{\n    $addressId = 2;\n    $address = $this->repository->getById($addressId);\n    $this->assertEquals($this->_expectedAddresses[1], $address);\n}\n")),(0,l.mdx)(m,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,l.mdx)("p",null,"In most cases, controller tests depend on the application state and require reinitialization in each test.\nThus, the test cases inherited from the ",(0,l.mdx)("inlineCode",{parentName:"p"},"\\Magento\\TestFramework\\TestCase\\AbstractController")," behave as if ",(0,l.mdx)("inlineCode",{parentName:"p"},"@magentoAppIsolation")," is enabled for each test."),(0,l.mdx)("h2",{id:"defaults"},"Defaults"),(0,l.mdx)("p",null,"Default values for the ",(0,l.mdx)("inlineCode",{parentName:"p"},"@magentoAppIsolation")," annotation:"),(0,l.mdx)("table",null,(0,l.mdx)("thead",{parentName:"table"},(0,l.mdx)("tr",{parentName:"thead"},(0,l.mdx)("th",{parentName:"tr",align:null},"Test class ancestors"),(0,l.mdx)("th",{parentName:"tr",align:null},"Test case (class)"),(0,l.mdx)("th",{parentName:"tr",align:null},"Test (method)"))),(0,l.mdx)("tbody",{parentName:"table"},(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},(0,l.mdx)("inlineCode",{parentName:"td"},"\\PHPUnit\\Framework\\TestCase")),(0,l.mdx)("td",{parentName:"tr",align:null},"enabled"),(0,l.mdx)("td",{parentName:"tr",align:null},"disabled")),(0,l.mdx)("tr",{parentName:"tbody"},(0,l.mdx)("td",{parentName:"tr",align:null},(0,l.mdx)("inlineCode",{parentName:"td"},"\\Magento\\TestFramework\\TestCase\\AbstractController")),(0,l.mdx)("td",{parentName:"tr",align:null},"enabled"),(0,l.mdx)("td",{parentName:"tr",align:null},"enabled")))),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"@magentoAppIsolation")," cannot be disabled at the test case level."),(0,l.mdx)("p",null,"You can use non-isolated tests unless they do not modify or utilize the same application areas such as:"),(0,l.mdx)("ul",null,(0,l.mdx)("li",{parentName:"ul"},"same attributes of an application object."),(0,l.mdx)("li",{parentName:"ul"},'same paths in a current configuration or current scope (for example "store").')),(0,l.mdx)(m,{variant:"success",slots:"text",mdxType:"InlineAlert"}),(0,l.mdx)("p",null,"Set up application isolation if any application objects were intentionally modified within the test case."))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guide-integration-annotations-magento-app-isolation-md-87a7ab02a9e9a5de8ccd.js.map