{"version":3,"file":"component---src-pages-guide-integration-attributes-db-isolation-md-e5db6a5fef04706a12a8.js","mappings":"sRAQaA,EAAe,CAAC,EACvBC,EAAc,CAClBD,aAAAA,GAEIE,EAAYC,EAAAA,EACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,GACF,YACD,OAAO,SAACJ,GAAD,UAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,eAG5E,eACE,GAAM,gCADR,iCAGA,wHAAyG,uBAAYC,WAAW,KAAvB,eAAzG,0BACO,uBAAYA,WAAW,KAAvB,eADP,oCAEA,oBACE,eAAIA,WAAW,MAAf,6DACA,eAAIA,WAAW,MAAf,wDACA,eAAIA,WAAW,MAAf,qDAEF,eACE,GAAM,UADR,WAGA,qBAAK,iBAAMA,WAAW,MAClB,UAAa,+BADZ,kDAML,eACE,GAAM,cADR,eAGA,oBACE,eAAIA,WAAW,OAAK,mBAAQA,WAAW,MAAnB,UAClB,eAAIA,WAAW,OACb,eAAIA,WAAW,MAAf,+CAIN,eACE,GAAM,wBADR,yBAGA,8LAC+B,eAAIA,WAAW,KAAf,sCAD/B,+RAImF,uBAAYA,WAAW,KAAvB,eAJnF,+BAKA,+BACA,qBAAK,iBAAMA,WAAW,MAClB,UAAa,+BADZ,o+BAuCL,eACE,GAAM,yBADR,0BAGA,2FAA4E,uBAAYA,WAAW,KAAvB,eAA5E,oCACA,qBAAK,iBAAMA,WAAW,MAClB,UAAa,+BADZ,ocAgBR,CAEDJ,EAAWK,gBAAiB,C","sources":["webpack://commerce-testing/./src/pages/guide/integration/attributes/db-isolation.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/commerce-testing/commerce-testing/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"database-isolation-attribute\"\n    }}>{`Database isolation attribute`}</h1>\n    <p>{`To isolate database changes between tests, the Integration testing framework (ITF) implements the `}<inlineCode parentName=\"p\">{`DbIsolation`}</inlineCode>{` attribute.\nWhen the `}<inlineCode parentName=\"p\">{`DbIsolation`}</inlineCode>{` attribute is enabled, the ITF:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Starts a database transaction before the test/test case.`}</li>\n      <li parentName=\"ul\">{`Avoids a database commit during the test/test case.`}</li>\n      <li parentName=\"ul\">{`Restores the database after the test/test case.`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"format\"\n    }}>{`Format`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php?start_inline=1\"\n      }}>{`#[\n    DbIsolation(bool $state = true)\n]\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"parameters\"\n    }}>{`Parameters`}</h3>\n    <ul>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`state`}</strong>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`Enables or disables database isolation.`}</li>\n        </ul>\n      </li>\n    </ul>\n    <h2 {...{\n      \"id\": \"test-class-attribute\"\n    }}>{`Test class attribute`}</h2>\n    <p>{`Use test class declarations when a sequence of tests introduces changes to the database and relies on the changes made by each other.\nFor example, typical CRUD tests: `}<em parentName=\"p\">{`create -> read -> update -> delete`}</em>{`.\nEvery next test method relies on a database state after the previous one.\nIf at any point of that sequence (after creation) the test method fails, the database will be polluted with test data.\nTo apply a database rollback after the test class, create a separate test class with `}<inlineCode parentName=\"p\">{`DbIsolation`}</inlineCode>{` enabled at a class level.`}</p>\n    <p>{`Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php?start_inline=1\"\n      }}>{`#[\n    DbIsolation(true)\n]\nclass Some\\\\EntityTest extends \\\\PHPUnit\\\\Framework\\\\TestCase\n{\n    public function testCreate()\n    {\n        $this->object->setData($this->initialData)->save();\n        $this->assertNotEmpty($this->object->getId());\n        return $this->object->getId();\n    }\n\n    public function testRead($objectId)\n    {\n        $this->object->load($objectId);\n        $this->assertEquals($this->initialData, $this->object->getData());\n        return $objectId;\n    }\n\n    public function testUpdate($objectId)\n    {\n        $this->object->setData($newData)->save();\n        $object = new Some_Entity();\n        $object->load($objectId);\n        $this->assertEquals($newData, $object->getData());\n        return $objectId;\n    }\n\n    public function testDelete($objectId)\n    {\n        $this->object->delete();\n        $object = new Some_Entity();\n        $object->load($objectId);\n        $this->assertEmpty($object->getData());\n    }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"test-method-attribute\"\n    }}>{`Test method attribute`}</h2>\n    <p>{`To isolate changes made to the database by a single test, enable the `}<inlineCode parentName=\"p\">{`DbIsolation`}</inlineCode>{` attribute for the test method.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-php?start_inline=1\"\n      }}>{`#[\n    DbIsolation(true)\n]\npublic function testSave()\n{\n    $taxClassDataObject = $this->taxClassFactory->create();\n    $taxClassDataObject->setClassName(self::SAMPLE_TAX_CLASS_NAME)\n        ->setClassType(TaxClassManagementInterface::TYPE_CUSTOMER);\n    $taxClassId = $this->taxClassRepository->save($taxClassDataObject);\n    $this->assertEquals(self::SAMPLE_TAX_CLASS_NAME, $this->taxClassModel->load($taxClassId)->getClassName());\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"sourceRoot":""}